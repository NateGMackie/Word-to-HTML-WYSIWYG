<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>W2H – Full WYSIWYG</title>
  <meta name="color-scheme" content="dark"/>

  <!-- Fonts + Tailwind (same as W2H.html) -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet"/>
  <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ["Inter","ui-sans-serif","system-ui","-apple-system","Segoe UI","Roboto","Helvetica","Arial"]
          }
        }
      }
    }
  </script>

  <!-- Your custom tweaks from app-ui.css -->
  <link rel="stylesheet" href="./src/styles/app-ui.css" />
  <link rel="stylesheet" href="./src/styles/editor-content.css" />
  <style>
  .tbtn.is-active {
    background-color: rgba(56, 189, 248, 0.16); /* soft sky tint */
    border-color: rgb(56, 189, 248);
  }
</style>

</head>
<body class="theme-dark antialiased">
  <!-- Dummy root to satisfy any external observers -->
  <div id="root" style="display:none"></div>

  <div class="h-screen flex overflow-hidden">
    <!-- LEFT RAIL -->
    <aside class="w-[76px] border-r border-subtle bg-sidebar">
      <div class="flex flex-col items-center py-4 gap-4">
        <div class="mt-1 mb-2 text-[10px] tracking-[0.2em] font-medium text-secondary">W2H</div>

        <!-- Views -->
        <button id="navWysiwyg"
                class="group w-12 h-12 btn-rail transition"
                title="WYSIWYG">
          <!-- icon -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4 12.5-12.5z"/>
          </svg>
        </button>

        <button id="navHtml"
                class="group w-12 h-12 btn-rail transition"
                title="Clean HTML">
          <!-- icon -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="m7 8-4 4 4 4"/><path d="m17 8 4 4-4 4"/><path d="m14 4-4 16"/>
          </svg>
        </button>

        <button id="navWord"
                class="group w-12 h-12 btn-rail transition"
                title="Word View">
          <!-- icon -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="9" y="2" width="6" height="4" rx="1"/>
            <path d="M9 4H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-3"/>
          </svg>
        </button>

        <div class="my-2 h-px w-10 bg-divider"></div>

        <!-- Global actions -->
        <button id="btnCopy"
                class="group w-12 h-12 btn-rail transition"
                title="Copy to Clipboard (Fragment)">
          <!-- icon -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect width="8" height="8" x="8" y="8" rx="2"/>
            <path d="M12 8V6a2 2 0 0 0-2-2H6"/>
            <path d="M16 16h2a2 2 0 0 0 2-2v-2"/>
          </svg>
        </button>

        <button id="btnSave"
                class="group w-12 h-12 btn-rail transition"
                title="Export HTML (Fragment)">
          <!-- icon -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M7 21h10a2 2 0 0 0 2-2V7.5L15.5 3H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2z"/>
            <path d="M7 7h8v4H7z"/>
          </svg>
        </button>

        <div class="flex-1"></div>
        <button id="btnThemeToggle"
                class="mb-3 px-2 py-1 rounded-md text-[10px] btn-theme transition">
          DARK
        </button>
      </div>
    </aside>

    <!-- MAIN -->
    <main class="flex-1 flex flex-col overflow-hidden">
      <!-- Header -->
      <div class="flex items-center justify-between px-4 py-3 border-b border-subtle bg-chrome">
        <div class="flex items-center gap-2">
          <span id="badgeActive"
                class="px-2 py-1 text-xs rounded-md border border-strong text-secondary">
            View: WYSIWYG
          </span>
        </div>

        <!-- Header menu -->
        <div class="relative">
          <button id="btnMenu"
                  class="inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md border border-strong text-secondary hover:border-sky-500 hover:bg-stone-800/70">
            <span>Menu</span>
            <!-- hamburger icon -->
            <svg xmlns="http://www.w3.org/2000/svg"
                 class="h-3.5 w-3.5"
                 viewBox="0 0 24 24"
                 fill="none"
                 stroke="currentColor"
                 stroke-width="1.5"
                 stroke-linecap="round"
                 stroke-linejoin="round">
              <line x1="4" y1="7" x2="20" y2="7"/>
              <line x1="4" y1="12" x2="20" y2="12"/>
              <line x1="4" y1="17" x2="20" y2="17"/>
            </svg>
          </button>

          <!-- Dropdown panel -->
          <div id="menuPanel"
     class="hidden absolute right-0 mt-2 w-44 rounded-md menu-panel shadow-lg text-xs text-primary z-20">
  <button id="menuNew"
          class="w-full text-left px-3 py-2 menu-item">
    New
  </button>

  <button id="menuImport"
          class="w-full text-left px-3 py-2 menu-item">
    Import
  </button>

  <div class="my-1 h-px w-full bg-divider"></div>

  <button id="menuOpenDraft"
          class="w-full text-left px-3 py-2 menu-item">
    Open draft…
  </button>

  <button id="menuSave"
          class="w-full text-left px-3 py-2 menu-item">
    Save draft
  </button>

  <button id="menuExportHtml"
          class="w-full text-left px-3 py-2 menu-item">
    Publish
  </button>
</div>

        </div>
      </div>

      <!-- Toolbars -->
      <div class="px-4 py-3 border-b border-subtle bg-chrome">
        <!-- Word toolbar -->
        <div id="toolsWord" class="flex items-center justify-between gap-2">
          <div class="flex flex-wrap gap-2">
            <button id="btnPaste"
                    class="px-3 py-1.5 rounded-md btn-accent">
              Paste
            </button>
            <button id="btnClean"
                    class="px-3 py-1.5 rounded-md btn-accent">
              Clean
            </button>
          </div>

          <div>
            <button id="btnClearAll"
                    class="px-3 py-1.5 rounded-md btn-danger focus:outline-none"
                    title="Clear all pasted content">
              Reset
            </button>
          </div>
        </div>

        <!-- HTML toolbar -->
        <div id="toolsHtml" class="hidden flex flex-wrap gap-2">
          <button id="btnFormatHtml"
                  class="px-3 py-1.5 rounded-md btn-accent">
            Update
          </button>
        </div>

        <!-- WYSIWYG toolbar -->
<div id="toolsWysiwyg" class="hidden">
  <div class="flex flex-wrap items-center gap-2">

    <!-- FONT tools -->
    <button data-action="bold" class="tbtn" title="Bold">B</button>
    <button data-action="italic" class="tbtn" title="Italic"><i>I</i></button>
    <button data-action="underline" class="tbtn" title="Underline"><u>U</u></button>
    <button data-action="strikeThrough" class="tbtn" title="Strikethrough">
      <span style="text-decoration:line-through">S</span>
    </button>
    <button data-action="subscript" class="tbtn" title="Subscript">x<sub>2</sub></button>
    <button data-action="superscript" class="tbtn" title="Superscript">x<sup>2</sup></button>
    <button data-action="link" class="tbtn" title="Insert link">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
           viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
        <path d="M15 7h3a5 5 0 0 1 0 10h-3"/>
        <path d="M9 17H6A5 5 0 0 1 6 7h3"/>
        <path d="M8 12h8"/>
      </svg>
    </button>
    <button data-action="unlink" class="tbtn" title="Remove link">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
           viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
        <path d="M15 7h3a5 5 0 0 1 0 10h-3"/>
        <path d="M9 17H6A5 5 0 0 1 6 7h3"/>
        <path d="M8 12h8"/>
        <path d="M4 4l3 3M17 17l3 3"/>
      </svg>
    </button>
    <button data-action="removeFormat" class="tbtn" title="Remove formatting">⌫</button>

    <!-- Divider -->
    <div class="toolbar-divider"></div>

    <!-- PARAGRAPH tools -->
    <button id="btnUl" class="tbtn" title="Bulleted list">•</button>
    <button id="btnOl" class="tbtn" title="Numbered list">1.</button>
    <button id="btnIndent" class="tbtn" title="Increase indent">→</button>
    <button id="btnOutdent" class="tbtn" title="Decrease indent">←</button>
    <button id="btnAlignLeft" class="tbtn" title="Align left">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
           viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
        <line x1="4" y1="6" x2="20" y2="6"/>
        <line x1="4" y1="10" x2="14" y2="10"/>
        <line x1="4" y1="14" x2="18" y2="14"/>
        <line x1="4" y1="18" x2="10" y2="18"/>
      </svg>
    </button>
    <button id="btnAlignCenter" class="tbtn" title="Align center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
           viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
        <line x1="6" y1="6" x2="18" y2="6"/>
        <line x1="4" y1="10" x2="20" y2="10"/>
        <line x1="7" y1="14" x2="17" y2="14"/>
        <line x1="5" y1="18" x2="19" y2="18"/>
      </svg>
    </button>
    <button id="btnAlignRight" class="tbtn" title="Align right">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
           viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
        <line x1="4" y1="6" x2="20" y2="6"/>
        <line x1="10" y1="10" x2="20" y2="10"/>
        <line x1="6" y1="14" x2="20" y2="14"/>
        <line x1="14" y1="18" x2="20" y2="18"/>
      </svg>
    </button>
    <button id="btnAlignJustify" class="tbtn" title="Justify">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
           viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
        <line x1="4" y1="6" x2="20" y2="6"/>
        <line x1="4" y1="10" x2="20" y2="10"/>
        <line x1="4" y1="14" x2="20" y2="14"/>
        <line x1="4" y1="18" x2="20" y2="18"/>
      </svg>
    </button>

    <!-- Divider -->
    <div class="toolbar-divider"></div>

    <!-- FORMAT & EXTRAS -->
    <div class="relative">
      <select id="stylesSelect" aria-label="Styles" title="Styles"
              class="appearance-none bg-stone-900/80 text-stone-200 text-sm px-3 py-1.5 pr-8 rounded-md border border-stone-800 hover:border-sky-500 focus:outline-none min-w-[12rem]">
        <option value="" selected disabled>Inline / Callout...</option>
        <optgroup label="Block">
          <option value="block:p">Paragraph</option>
          <option value="block:h1">Heading 1</option>
          <option value="block:h2">Heading 2</option>
          <option value="block:h3">Heading 3</option>
          <option value="block:blockquote">Quote</option>
          <option value="block:pre">Code Block</option>
        </optgroup>
        <optgroup label="Callouts">
          <option value="callout:note">Note</option>
          <option value="callout:example">Example</option>
          <option value="callout:warning">Warning</option>
          <option value="callout:remove">Remove callout</option>
        </optgroup>
      </select>

      <div class="pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 text-stone-500">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="m6 9 6 6 6-6"/>
        </svg>
      </div>
    </div>

    <button id="btnScreenshot" class="tbtn" title="Mark screenshot">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
           viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
        <path d="M5 7h3l2-3h4l2 3h3"/>
        <path d="M2 7h20v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2Z"/>
        <circle cx="12" cy="13" r="4"/>
      </svg>
    </button>

    <button id="btnInsertTable" class="tbtn" title="Insert table">
  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
       viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
    <rect x="3" y="5" width="18" height="14" rx="2"/>
    <path d="M3 10h18"/>
    <path d="M8 5v14"/>
    <path d="M16 5v14"/>
  </svg>
</button>

    <button id="btnNormalizeTable" class="tbtn" title="Normalize table">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
           viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
        <rect x="3" y="5" width="18" height="14" rx="2"/>
        <path d="M3 10h18"/>
        <path d="M8 5v14"/>
        <path d="M16 5v14"/>
      </svg>
    </button>

    <button id="btnUserInput" class="tbtn" title="Mark user input">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
           viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
        <rect x="3" y="7" width="18" height="10" rx="2"/>
        <path d="M6 11h12"/>
        <path d="M5 15h14"/>
      </svg>
    </button>

    <button id="btnVariable" class="tbtn" title="Insert/Toggle variable">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
           viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
        <path d="M7 7c2 0 2 10 4 10"/>
        <path d="M17 7c-2 0-2 10-4 10"/>
        <path d="M10 12h4"/>
      </svg>
    </button>

    <button id="btnHr" class="tbtn" title="Insert horizontal rule">―</button>

  </div>
</div>

      </div>

      <!-- Views -->
      <section class="flex-1 min-h-0 overflow-hidden">
        <div id="viewWord" class="h-full flex flex-col p-1">
          <div id="wordInput"
               contenteditable="true"
               class="flex-1 min-h-0 p-3 rounded-md border border-strong bg-panel overflow-auto">
          </div>
        </div>

        <div id="viewHtml" class="hidden h-full flex flex-col p-1">
        
          <textarea id="htmlEditor"
                    spellcheck="false"
                    class="flex-1 min-h-0 w-full resize-none p-3 rounded-md border border-strong bg-panel font-mono overflow-auto"></textarea>
        </div>

        
        <!-- WYSIWYG view -->
<div id="viewWysiwyg" class="h-full flex flex-col p-1">
  <div
    id="wysiwygRoot"
    class="flex-1 min-h-0 rounded-md border border-strong bg-panel overflow-auto"></div>
</div>



</section>
 

      <!-- Document stats footer -->
      <footer class="px-4 py-2 border-t border-subtle bg-chrome text-xs text-quiet flex items-center justify-end gap-4">
        <div>HTML size: <span id="statBytes">0</span> bytes</div>
        <div>Words: <span id="statWords">0</span></div>
      </footer>

    </main>
  </div>

  <template id="export-css">
/*-------------------------------------
  1. General Typography
-------------------------------------*/
body {
    font-family: Arial, sans-serif;
    font-size: 14px;
    line-height: 1.6;
    color: #333;
}

/*-------------------------------------
  2. Headings
-------------------------------------*/
h1 {
    font-size: 22px !important;
    font-weight: bold;
    margin-bottom: 10px;
    color: #222;
}

h2 {
    font-size: 18px !important;
    font-weight: bold;
    margin-top: 40px;
    margin-bottom: 8px;
    color: #333;
}

h3 {
    font-size: 16px !important;
    font-weight: bold;
    margin-top: 18px;
    margin-bottom: 6px;
    color: #444;
}

/*-------------------------------------
  3. Paragraphs
-------------------------------------*/
p {
    margin-bottom: 12px;
}

/*-------------------------------------
  4. Lists
-------------------------------------*/
ul, ol {
    margin-left: 20px;
    padding-left: 0;
    list-style-position: inside; /* Required by ServiceNow */
}

ul li, ol li {
    margin-bottom: 6px;
    position: relative;
    padding-left: 20px;
    text-indent: -20px; /* Creates hanging indent */
}

ul li::marker,
ol li::marker {
    font-weight: bold;
}

/* Fix line breaks in list items */
ul li br,
ol li br {
    display: block;
    content: "";
    margin-left: 20px;
}

/*-------------------------------------
  5. Tables
-------------------------------------*/
table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
}

th, thead, td {
    border: 1px solid #ddd;
    padding: 8px;
}

th, thead {
    background-color: #f4f4f4;
    font-weight: bold;
}

/*-------------------------------------
  6. Code Blocks
-------------------------------------*/
pre {
    background: #f5f5f5;
    padding: 10px;
    border-radius: 4px;
    font-family: monospace;
}

/*-------------------------------------
  7. Links
-------------------------------------*/
a {
    color: #0056b3;
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

/*-------------------------------------
  8. Callouts (Note, Warning, Example)
-------------------------------------*/
.callout {
    padding: 1em;
    margin: 1em 0;
    font-family: sans-serif;
    white-space: normal;
    box-sizing: border-box;
}

.callout.note {
    background-color: #f9f9f9;
    border-left: 4px solid #0073e6;
}

.callout.warning {
    background-color: #fff3cd;
    border-left: 4px solid #ff9800;
}

.callout.example {
    background-color: #f0f0f0; /* Improved contrast */
    border-left: 4px solid #aaa; /* Clearer framing */
}

/* Adjust spacing/indentation inside lists */
li .note,
li .warning,
li .example-block {
    text-indent: 0;
    padding-left: 1em;
    margin-left: 0;
    display: block;
}

li > .note,
li > .warning,
li > .example-block {
    margin-top: 0.5em;
}

/*-------------------------------------
  9. User Input Formatting
-------------------------------------*/
.user-input {
    font-family: Consolas, monospace;
    background-color: #e0e0e0; /* Enhanced accessibility */
    padding: 2px 4px;
    border-radius: 3px;
    color: #000;
}

.user-input .variable {
    font-style: italic;
    color: #333;
}

/*-------------------------------------
  10. Screenshots
-------------------------------------*/
.screenshot {
    border: 1px solid #000;
    display: block;
    margin: 12px 0;
    max-width: 100%;
    height: auto;
}

/*-------------------------------------
  11. DRAFT Watermark - Apply conditionally via a class on <body> or wrapper
-------------------------------------*/
body.draft::before {
    content: "DRAFT";
    position: fixed;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%) rotate(-30deg);
    font-size: 6em;
    color: rgba(200, 200, 200, 0.2);
    z-index: 0;
    pointer-events: none;
    white-space: nowrap;
}
  </template>

  <script type="module" src="./src/main.js"></script>
</body>
</html>
